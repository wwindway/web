<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Nanum+Gothic&display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
      }
      section {
        font-family: "Nanum Gothic", sans-serif;
        width: 100%;
        height: 100vh;
        background: #eee;
        display: flex;
        gap: 20px;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }
      section:nth-child(1) h1 {
        font-size: 64px;
      }
      section:nth-child(2) {
        background-color: white;
      }
    </style>
  </head>
  <body>
    <section>
      <h1>Portfolio</h1>
    </section>
    <section>
      <h1>skill</h1>
      <div>
        <canvas
          width="1200"
          height="400"
          style="border: 1px solid red"
          id="can"
        ></canvas>
      </div>
    </section>
    <section></section>
    <script>
      let ctx = document.querySelector("#can").getContext("2d");

      function circle(x, y, radius, fillCircle, color, duration) {
        ctx.beginPath();
        ctx.fillStyle = color;
        ctx.strokeStyle = color;
        ctx.lineWidth = 20;
        ctx.arc(x, y, radius, 0, Math.PI * duration, false);
        if (fillCircle) {
          ctx.fill();
        } else {
          ctx.stroke();
        }
      }

      function drawText(x, y, color, txt) {
        ctx.font = "24px Nanum Gothic";
        ctx.fillStyle = color;
        ctx.txtAlign = "left";
        ctx.textBaseline = "middle";
        ctx.fillText(txt, x, y);
      }

      let circles = [];
      circles.push({
        x: 180,
        y: 200,
        radius: 80,
        color: "#0088CC",
        duration: 0,
        maxDuration: 1.8,
        text: "PhotoShop",
        text2: "100%",
      });
      circles.push({
        x: 460,
        y: 200,
        radius: 80,
        color: "#e36159",
        duration: 0,
        maxDuration: 1.9,
        text: "Illustrator",
        text2: "90%",
      });
      circles.push({
        x: 700,
        y: 200,
        radius: 80,
        color: "#2BAAB1",
        duration: 0,
        maxDuration: 1.9,
        text: "html/css",
        text2: "100%",
      });
      circles.push({
        x: 920,
        y: 200,
        radius: 80,
        color: "#383f48",
        duration: 0,
        maxDuration: 1.2,
        text: "Jquery",
        text2: "60%",
      });

      function draw() {
        ctx.clearRect(0, 0, 1200, 400);
        let allFinished = true; // 모든 애니메이션이 끝났는지 확인하는 플래그

        circles.forEach((element) => {
          // duration 업데이트
          if (element.duration < element.maxDuration) {
            // 프레임당 증가량을 작게 설정하여 부드러운 애니메이션을 만듭니다.
            element.duration += 0.05;

            // maxDuration을 초과하면 maxDuration으로 고정
            if (element.duration > element.maxDuration) {
              element.duration = element.maxDuration;
            }
            allFinished = false; // 하나라도 진행 중이면 false
          }

          // 원 그리기 (원래 코드에서는 Math.PI * duration이므로, maxDuration: 2가 되어야 360도)
          circle(
            element.x,
            element.y,
            element.radius,
            false,
            element.color,
            element.duration
          );

          // 텍스트 그리기
          drawText(
            element.x - 50,
            element.y - 130,
            element.color,
            element.text
          );
          drawText(element.x - 30, element.y, element.color, element.text2);
        });

        // 애니메이션이 끝나지 않았으면 다음 프레임 요청
        if (!allFinished) {
          requestAnimationFrame(draw);
        }
      }

      // 애니메이션 시작
      draw();
    </script>
  </body>
</html>
